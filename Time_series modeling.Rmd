---
title: "R Notebook"
output:
  html_notebook: default
  html_document:
    df_print: paged
  pdf_document: default
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code.

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*.

```{r}
library(forecast)
library(MTS)
library(igraph)
library(vars)
library(tseries)

#install.packages("pracma")  # If not already installed
library(pracma)
```

```{r}


 LD_15_awake=c(0.03104575, 0.03611111, 0.03112745, 0.03464052, 0.03071895,
          0.03349673, 0.03464052, 0.03488562, 0.0369281 , 0.03504902,
          0.03390523, 0.03545752, 0.03210784, 0.03357843, 0.03325163,
          0.03611111, 0.03308824, 0.03292484, 0.03602941, 0.03406863,
          0.02769608, 0.03480392, 0.02949346, 0.03055556, 0.03218954,
          0.03415033, 0.03316993, 0.03161765, 0.03423203, 0.03137255,
          0.03496732, 0.03382353, 0.03169935, 0.03186275, 0.03627451,
          0.03235294, 0.03374183, 0.03300654, 0.03300654, 0.03316993,
          0.03390523, 0.03382353, 0.03366013, 0.03439542, 0.03398693,
          0.03627451, 0.03382353, 0.03553922, 0.03643791, 0.0375817 ,
          0.03194444, 0.03431373, 0.03308824, 0.03398693, 0.03169935,
          0.03235294, 0.03243464, 0.03088235, 0.03178105, 0.03374183,
          0.03276144, 0.03366013, 0.03374183, 0.03088235, 0.03529412,
          0.03284314, 0.03341503, 0.03063725, 0.03096405, 0.02982026,
          0.03464052, 0.03071895, 0.03366013, 0.03455882, 0.03218954,
          0.03284314, 0.03153595, 0.03112745, 0.03039216, 0.0127451 )


LD_15_awake
mean(LD_15_awake)
var(LD_15_awake)

plot.ts(LD_15_awake)
#model=auto.arima(LD_15_awake)
#model
```

```{r}

Box.test(LD_15_awake,type="Ljung-Box")
plot.ts(LD_15_awake)
acf(LD_15_awake)
pacf(LD_15_awake)

```

```{r}
library(forecast)
LD_15_iso=c(0.01478758, 0.0120915 , 0.01331699, 0.01168301, 0.01143791,
          0.01315359, 0.01323529, 0.01356209, 0.0120915 , 0.01135621,
          0.0125    , 0.01037582, 0.01119281, 0.01111111, 0.0120098 ,
          0.0125    , 0.01037582, 0.01372549, 0.0128268 , 0.00996732,
          0.00972222, 0.01176471, 0.01168301, 0.0128268 , 0.01486928,
          0.01127451, 0.01405229, 0.01364379, 0.0127451 , 0.01372549,
          0.01184641, 0.01364379, 0.01421569, 0.01364379, 0.01135621,
          0.01143791, 0.01119281, 0.0130719 , 0.01405229, 0.0128268 ,
          0.01462418, 0.01356209, 0.01102941, 0.01127451, 0.00964052,
          0.01111111, 0.0120915 , 0.01111111, 0.0121732 , 0.01151961,
          0.01315359, 0.00996732, 0.01168301, 0.0125    , 0.0123366 ,
          0.0121732 , 0.00988562, 0.01086601, 0.01184641, 0.0124183 ,
          0.01364379, 0.0128268 , 0.01462418, 0.01380719, 0.01062092,
          0.01127451, 0.01037582, 0.01143791, 0.0124183 , 0.01070261,
          0.00964052, 0.00996732, 0.01053922, 0.01111111, 0.01086601,
          0.0125817 , 0.01102941, 0.01135621, 0.0121732 , 0.00645425)



adf.test(LD_15_iso)

Box.test(LD_15_iso)
acf(LD_15_iso)
pacf(LD_15_iso)
plot.ts(LD_15_iso)

m15_iso=auto.arima(LD_15_iso)
summary(m15_iso)
```

```{r}


LD_15_recovery=c(0.01985294, 0.02017974, 0.01797386, 0.02279412, 0.02050654,
          0.01952614, 0.02017974, 0.02009804, 0.02116013, 0.02140523,
          0.02042484, 0.02034314, 0.02156863, 0.02197712, 0.02009804,
          0.01952614, 0.01960784, 0.02058824, 0.01895425, 0.01821895,
          0.01772876, 0.01985294, 0.01879085, 0.02197712, 0.01952614,
          0.01993464, 0.02271242, 0.02017974, 0.01944444, 0.01952614,
          0.01968954, 0.02083333, 0.01944444, 0.02205882, 0.02099673,
          0.02026144, 0.01911765, 0.02197712, 0.02189542, 0.02107843,
          0.02124183, 0.01919935, 0.02165033, 0.02050654, 0.02238562,
          0.02124183, 0.02312092, 0.02344771, 0.0246732 , 0.02189542,
          0.02271242, 0.02148693, 0.01887255, 0.02132353, 0.02238562,
          0.02001634, 0.02214052, 0.01985294, 0.02001634, 0.02026144,
          0.02075163, 0.01944444, 0.02181373, 0.02017974, 0.01919935,
          0.02017974, 0.02116013, 0.02017974, 0.02279412, 0.01985294,
          0.02017974, 0.02034314, 0.02214052, 0.01985294, 0.01764706,
          0.02156863, 0.02050654, 0.02124183, 0.02091503, 0.02107843)

Box.test(LD_15_recovery)
acf(LD_15_recovery)
pacf(LD_15_recovery)
plot.ts(LD_15_recovery)

m15_r=auto.arima(LD_15_recovery)
summary(m15_r)
```

```{r}

LD_35_awake=c(0.03480392, 0.03031046, 0.03178105, 0.02916667, 0.03194444,
          0.03161765, 0.03178105, 0.03284314, 0.03080065, 0.03112745,
          0.03096405, 0.02965686, 0.03161765, 0.03129085, 0.03047386,
          0.03137255, 0.02900327, 0.03039216, 0.03439542, 0.03169935,
          0.03619281, 0.03194444, 0.02614379, 0.02328431, 0.02426471,
          0.02091503, 0.02393791, 0.02426471, 0.025     , 0.02769608,
          0.02753268, 0.03006536, 0.03120915, 0.03251634, 0.0375817 ,
          0.03651961, 0.04003268, 0.0377451 , 0.03570261, 0.0379085 ,
          0.03643791, 0.03488562, 0.0380719 , 0.03210784, 0.03243464,
          0.03080065, 0.03022876, 0.03153595, 0.03300654, 0.03178105,
          0.03161765, 0.02892157, 0.03218954, 0.03366013, 0.03129085,
          0.03218954, 0.03235294, 0.03063725, 0.03145425, 0.03423203,
          0.03137255, 0.03464052, 0.03357843, 0.03153595, 0.03137255,
          0.03063725, 0.03267974, 0.03153595, 0.03210784, 0.03300654,
          0.03145425, 0.03333333, 0.03570261, 0.03080065, 0.02843137,
          0.02834967, 0.03104575, 0.03178105, 0.03210784, 0.01952614)
Box.test(LD_35_awake,type = c("Box-Pierce", "Ljung-Box"))
kpss.test(LD_15_awake)
plot.ts(LD_35_awake)
acf(LD_35_awake)

pacf(LD_35_awake)

m35_a=auto.arima(LD_35_awake)
summary(m35_a)


```

```{r}
library(forecast)
LD_35_iso=c(0.01102941, 0.01184641, 0.01070261, 0.01160131, 0.01045752,
          0.01062092, 0.01160131, 0.01356209, 0.01405229, 0.01388889,
          0.01078431, 0.01168301, 0.01078431, 0.01176471, 0.0120915 ,
          0.01184641, 0.01111111, 0.01045752, 0.01045752, 0.00931373,
          0.01004902, 0.0124183 , 0.01184641, 0.00898693, 0.00923203,
          0.00718954, 0.00784314, 0.00620915, 0.00702614, 0.00825163,
          0.00874183, 0.00955882, 0.00906863, 0.01053922, 0.00800654,
          0.00841503, 0.00906863, 0.01037582, 0.00841503, 0.01135621,
          0.01127451, 0.01070261, 0.01102941, 0.01045752, 0.01160131,
          0.00947712, 0.01045752, 0.00890523, 0.00972222, 0.00882353,
          0.00955882, 0.00964052, 0.00784314, 0.01045752, 0.00955882,
          0.01029412, 0.01086601, 0.00939542, 0.00849673, 0.00816993,
          0.00939542, 0.01021242, 0.00947712, 0.00923203, 0.00972222,
          0.01037582, 0.01168301, 0.01078431, 0.00898693, 0.00996732,
          0.01021242, 0.01070261, 0.01086601, 0.00988562, 0.0120098 ,
          0.00915033, 0.00947712, 0.01053922, 0.01111111, 0.00637255)
plot.ts(LD_35_iso)

adf.test(LD_35_iso)
acf(LD_35_iso)
pacf(LD_35_iso)
Box.test(LD_35_iso,type = c("Box-Pierce", "Ljung-Box"))

modela=auto.arima(LD_35_iso)
summary(modela)

#mod2=arima(LD_35_iso,order = c(4,0,0))

#summary(mod2)
```

```{r}


LD_35_recovery=c(0.02369281, 0.0244281 , 0.02116013, 0.02647059, 0.02434641,
          0.02418301, 0.02385621, 0.02344771, 0.0245915 , 0.02295752,
          0.02271242, 0.02352941, 0.0247549 , 0.02336601, 0.02099673,
          0.02401961, 0.02385621, 0.01928105, 0.02001634, 0.02050654,
          0.02091503, 0.02344771, 0.01821895, 0.01748366, 0.01936275,
          0.01683007, 0.01764706, 0.02246732, 0.01911765, 0.02066993,
          0.02238562, 0.02124183, 0.02075163, 0.02263072, 0.02083333,
          0.02254902, 0.02385621, 0.0250817 , 0.02181373, 0.02352941,
          0.02189542, 0.02377451, 0.0246732 , 0.02214052, 0.02124183,
          0.02377451, 0.02034314, 0.01944444, 0.02352941, 0.02181373,
          0.02075163, 0.02132353, 0.01830065, 0.02132353, 0.01854575,
          0.02017974, 0.02173203, 0.02017974, 0.01903595, 0.01960784,
          0.01862745, 0.01854575, 0.01879085, 0.02083333, 0.01993464,
          0.02001634, 0.02230392, 0.02050654, 0.02344771, 0.02107843,
          0.02156863, 0.02009804, 0.02295752, 0.02165033, 0.02148693,
          0.02173203, 0.01960784, 0.02050654, 0.02042484, 0.02189542)


plot.ts(LD_35_recovery)

acf(LD_35_recovery,lag.max = 10)
pacf(LD_35_recovery,lag.max = 10)
Box.test(LD_35_recovery,type = c("Box-Pierce", "Ljung-Box"))

model1=auto.arima(LD_35_recovery)
summary(model1)

#model2=Arima(LD_35_recovery,order=c(6,0,3))
#summary(model2)
```

```{r}
LD_60_awake=c(0.03439542, 0.03423203, 0.03553922, 0.03455882, 0.03586601,
          0.03366013, 0.03545752, 0.03308824, 0.03267974, 0.03308824,
          0.03398693, 0.03178105, 0.03218954, 0.03210784, 0.03464052,
          0.03186275, 0.03169935, 0.03382353, 0.03267974, 0.03022876,
          0.04281046, 0.03088235, 0.0249183 , 0.02246732, 0.02426471,
          0.02287582, 0.02230392, 0.0252451 , 0.02312092, 0.02606209,
          0.02802288, 0.03145425, 0.03905229, 0.0378268 , 0.04460784,
          0.04918301, 0.04656863, 0.04779412, 0.04705882, 0.04256536,
          0.04199346, 0.04019608, 0.04150327, 0.03439542, 0.03570261,
          0.03635621, 0.03978758, 0.03676471, 0.03929739, 0.04027778,
          0.0375817 , 0.03651961, 0.04027778, 0.04093137, 0.03660131,
          0.03684641, 0.03553922, 0.03929739, 0.0374183 , 0.03986928,
          0.03398693, 0.03651961, 0.03651961, 0.03815359, 0.03929739,
          0.0374183 , 0.03578431, 0.03872549, 0.03578431, 0.03406863,
          0.03120915, 0.03447712, 0.03039216, 0.03137255, 0.03276144,
          0.03504902, 0.03104575, 0.03325163, 0.03169935, 0.01437908)
  
plot.ts(LD_60_awake)

acf(LD_60_awake,lag.max = 10)
pacf(LD_60_awake,lag.max = 10)
Box.test(LD_60_awake,type = c("Box-Pierce", "Ljung-Box"))

model1=auto.arima(LD_60_awake)
summary(model1)

model2=Arima(LD_60_awake,order=c(0,0,2))
summary(model2)




  
```

```{r}
model26=arima(LD_60_awake,order=c(2,0,0))
summary(model26)
plot.ts(residuals(model26))
Box.test(residuals(model26))

```

```{r}

LD_60_iso=c(0.01119281, 0.01029412, 0.01127451, 0.01086601, 0.01102941,
          0.01021242, 0.01111111, 0.01168301, 0.00955882, 0.00996732,
          0.00874183, 0.00947712, 0.0125817 , 0.0122549 , 0.01086601,
          0.01135621, 0.01356209, 0.0121732 , 0.01062092, 0.01111111,
          0.01119281, 0.01397059, 0.00996732, 0.00931373, 0.00841503,
          0.00686275, 0.00629085, 0.00710784, 0.00735294, 0.00857843,
          0.00816993, 0.00898693, 0.00808824, 0.00857843, 0.00816993,
          0.00743464, 0.00816993, 0.00972222, 0.00931373, 0.00923203,
          0.00898693, 0.00906863, 0.00874183, 0.00947712, 0.01029412,
          0.01127451, 0.01078431, 0.01045752, 0.01086601, 0.00874183,
          0.00939542, 0.01045752, 0.00898693, 0.00882353, 0.01037582,
          0.01184641, 0.01062092, 0.00898693, 0.00996732, 0.01102941,
          0.01135621, 0.0124183 , 0.01037582, 0.01094771, 0.01070261,
          0.00866013, 0.0121732 , 0.0121732 , 0.0121732 , 0.0120915 ,
          0.01078431, 0.0128268 , 0.01078431, 0.01176471, 0.00939542,
          0.00882353, 0.01037582, 0.00923203, 0.00947712, 0.00490196)


Box.test(LD_60_iso,type = c("Ljung-Box"))

plot.ts(LD_60_iso)

acf(LD_60_iso)
pacf(LD_60_iso)
model_60_iso=auto.arima(LD_60_awake)
summary(model_60_iso)

```

```{r}
model_60_iso=arima(LD_60_iso,order=c(1,0,1))
summary(model_60_iso)
```

```{r}
model_60_iso=arima(LD_60_iso,order=c(1,0,0))
summary(model_60_iso)

```

```{r}
LD_60_recovery=c(0.02295752, 0.02116013, 0.02017974, 0.02222222, 0.02140523,
          0.02165033, 0.01781046, 0.02214052, 0.02124183, 0.02222222,
          0.02124183, 0.02295752, 0.02099673, 0.02434641, 0.01838235,
          0.02050654, 0.02099673, 0.02246732, 0.02197712, 0.01911765,
          0.02042484, 0.02205882, 0.01764706, 0.01421569, 0.01356209,
          0.01568627, 0.0127451 , 0.01429739, 0.01323529, 0.01348039,
          0.01478758, 0.01527778, 0.01781046, 0.01609477, 0.01658497,
          0.02058824, 0.02426471, 0.02573529, 0.02647059, 0.0246732 ,
          0.02736928, 0.025     , 0.02589869, 0.02589869, 0.02328431,
          0.02565359, 0.02246732, 0.02369281, 0.02418301, 0.02116013,
          0.02410131, 0.02026144, 0.02050654, 0.02124183, 0.02173203,
          0.02271242, 0.02263072, 0.02312092, 0.0248366 , 0.02312092,
          0.02132353, 0.02205882, 0.02148693, 0.02156863, 0.02410131,
          0.02328431, 0.02026144, 0.02287582, 0.02083333, 0.02377451,
          0.02271242, 0.02075163, 0.02336601, 0.02165033, 0.02181373,
          0.02181373, 0.02246732, 0.01985294, 0.02058824, 0.02042484)
adf.test(LD_60_recovery)
Box.test(LD_60_recovery)

plot.ts(LD_60_recovery)
acf(LD_15_recovery)
pacf(LD_15_recovery)

model=auto.arima(LD_15_recovery)
summary(model)

Box.test(residuals(model))
```

```{r}
PO_15_awake=c(0.06821534, 0.0710177 , 0.07123894, 0.06969027, 0.06792035,
          0.07064897, 0.07094395, 0.07581121, 0.07529499, 0.07234513,
          0.07249263, 0.07558997, 0.07883481, 0.07617994, 0.0740413 ,
          0.07743363, 0.07735988, 0.07146018, 0.07028024, 0.07035398,
          0.06777286, 0.06998525, 0.06954277, 0.07028024, 0.07094395,
          0.07278761, 0.07146018, 0.07735988, 0.07389381, 0.07131268,
          0.0679941 , 0.0730826 , 0.07028024, 0.06924779, 0.06954277,
          0.07352507, 0.06954277, 0.0729351 , 0.0730826 , 0.0719764 ,
          0.06747788, 0.07382006, 0.06902655, 0.07064897, 0.07699115,
          0.07485251, 0.07374631, 0.07492625, 0.07492625, 0.07153392,
          0.06747788, 0.07558997, 0.06688791, 0.06858407, 0.0740413 ,
          0.07028024, 0.07160767, 0.06887906, 0.06814159, 0.06917404,
          0.07470501, 0.06917404, 0.06806785, 0.07153392, 0.07212389,
          0.06740413, 0.07064897, 0.06666667, 0.06939528, 0.0670354 ,
          0.06880531, 0.0719764 , 0.06969027, 0.07042773, 0.06961652,
          0.07330383, 0.06954277, 0.07610619, 0.06961652, 0.02949853)

Box.test(PO_15_awake)
          
plot.ts(PO_15_awake)
acf(PO_15_awake)
pacf(PO_15_awake)
auto.arima(PO_15_awake)



```

```{r}

  PO_15_iso=  c(0.01224189, 0.01238938, 0.01157817, 0.0129056 , 0.01224189,
          0.01187316, 0.01253687, 0.0129056 , 0.0119469 , 0.01364307,
          0.01386431, 0.01460177, 0.01172566, 0.0120944 , 0.01216814,
          0.0120944 , 0.01128319, 0.01320059, 0.0120944 , 0.0130531 ,
          0.01150442, 0.01615044, 0.01253687, 0.01261062, 0.01297935,
          0.01238938, 0.01143068, 0.0120944 , 0.01238938, 0.01268437,
          0.01202065, 0.01224189, 0.0120944 , 0.01187316, 0.01246313,
          0.0130531 , 0.01275811, 0.01349558, 0.01334808, 0.01187316,
          0.0130531 , 0.0129056 , 0.01460177, 0.01238938, 0.01268437,
          0.01430678, 0.01438053, 0.01342183, 0.01283186, 0.01084071,
          0.01349558, 0.01430678, 0.01061947, 0.01113569, 0.01261062,
          0.01297935, 0.0130531 , 0.01327434, 0.0130531 , 0.01231563,
          0.01179941, 0.01371681, 0.01349558, 0.01342183, 0.0149705 ,
          0.01312684, 0.01261062, 0.0140118 , 0.01216814, 0.01231563,
          0.01106195, 0.01297935, 0.01364307, 0.01054572, 0.01113569,
          0.01143068, 0.01113569, 0.01120944, 0.01261062, 0.00811209)
Box.test(PO_15_iso)
plot.ts(PO_15_iso)
acf(PO_15_iso)
pacf(PO_15_iso)
auto.arima(PO_15_iso)

```

```{r}

PO_15_recovery=c(0.05117994, 0.04815634, 0.05390855, 0.05250737, 0.05022124,
          0.0519174 , 0.05339233, 0.05412979, 0.04963127, 0.05117994,
          0.0509587 , 0.05405605, 0.0539823 , 0.05523599, 0.0520649 ,
          0.04845133, 0.0550885 , 0.05044248, 0.05294985, 0.04705015,
          0.04749263, 0.05066372, 0.05029499, 0.05228614, 0.05258112,
          0.04985251, 0.04874631, 0.0520649 , 0.04911504, 0.05243363,
          0.05420354, 0.05287611, 0.05066372, 0.05501475, 0.05287611,
          0.05287611, 0.0550885 , 0.054941  , 0.04941003, 0.05361357,
          0.05648968, 0.05272861, 0.05331858, 0.05383481, 0.05538348,
          0.05575221, 0.05420354, 0.05058997, 0.05427729, 0.05612094,
          0.05154867, 0.05140118, 0.05789086, 0.05110619, 0.0530236 ,
          0.05715339, 0.05921829, 0.05715339, 0.05648968, 0.05671091,
          0.05243363, 0.05501475, 0.05272861, 0.0520649 , 0.05199115,
          0.05435103, 0.05154867, 0.04963127, 0.05612094, 0.05044248,
          0.05567847, 0.0530236 , 0.05294985, 0.05339233, 0.05656342,
          0.0539823 , 0.0519174 , 0.05693215, 0.05464602, 0.05125369)
Box.test(PO_15_recovery)
plot.ts(PO_15_recovery)
acf(PO_15_recovery)
pacf(PO_15_recovery)
auto.arima(PO_15_recovery)
```

```{r}
model_Po_rec=arima(PO_15_recovery,order=c(3,0,1))
summary(model_Po_rec)

```

```{r}

PO_35_awake=c(0.07264012, 0.07182891, 0.07323009, 0.07337758, 0.07264012,
          0.07072271, 0.06865782, 0.06998525, 0.07094395, 0.06887906,
          0.06710914, 0.06688791, 0.06932153, 0.06814159, 0.07028024,
          0.06710914, 0.07146018, 0.06777286, 0.07028024, 0.06415929,
          0.06843658, 0.06541298, 0.06165192, 0.05361357, 0.05221239,
          0.05958702, 0.06238938, 0.06312684, 0.06939528, 0.06393805,
          0.06334808, 0.06541298, 0.0629056 , 0.06224189, 0.06563422,
          0.0699115 , 0.06961652, 0.07337758, 0.07094395, 0.07109145,
          0.07558997, 0.07743363, 0.07721239, 0.07374631, 0.07020649,
          0.07182891, 0.07367257, 0.07271386, 0.070059  , 0.07087021,
          0.06349558, 0.06910029, 0.06821534, 0.06961652, 0.07581121,
          0.06932153, 0.07234513, 0.07138643, 0.07315634, 0.0740413 ,
          0.07153392, 0.06902655, 0.07160767, 0.07123894, 0.06998525,
          0.07249263, 0.0729351 , 0.0679941 , 0.06836283, 0.06814159,
          0.0730826 , 0.0719764 , 0.07264012, 0.07138643, 0.07249263,
          0.07131268, 0.06998525, 0.075     , 0.07168142, 0.03967552)

plot.ts(PO_35_awake)
acf(PO_35_awake)
pacf(PO_35_awake)
model=auto.arima(PO_35_awake)
summary(model)
```

```{r}
model_PO_35_awake=arima(PO_35_awake,order=c(2,0,0))
summary(model_PO_35_awake)
```

```{r}

PO_35_iso=c(0.01231563, 0.01393805, 0.01430678, 0.01438053, 0.01334808,
          0.01106195, 0.01371681, 0.01371681, 0.01320059, 0.0120944 ,
          0.01312684, 0.01423304, 0.01460177, 0.01651917, 0.0149705 ,
          0.01556047, 0.01615044, 0.01327434, 0.01334808, 0.0109882 ,
          0.01216814, 0.01460177, 0.01556047, 0.01106195, 0.01246313,
          0.01179941, 0.01076696, 0.01216814, 0.01312684, 0.01320059,
          0.01379056, 0.0119469 , 0.01246313, 0.01312684, 0.01246313,
          0.01356932, 0.01349558, 0.01202065, 0.01216814, 0.01253687,
          0.01216814, 0.01261062, 0.01143068, 0.01224189, 0.01165192,
          0.01231563, 0.01261062, 0.01342183, 0.01113569, 0.01120944,
          0.01128319, 0.01238938, 0.01224189, 0.01275811, 0.01320059,
          0.01297935, 0.0109882 , 0.01120944, 0.01076696, 0.01113569,
          0.01047198, 0.00966077, 0.01157817, 0.01120944, 0.0149705 ,
          0.0120944 , 0.01202065, 0.01261062, 0.01238938, 0.01275811,
          0.01349558, 0.01408555, 0.01143068, 0.0129056 , 0.01128319,
          0.01061947, 0.01172566, 0.01084071, 0.01165192, 0.00722714)


plot.ts(PO_35_iso)
acf(PO_35_iso)
pacf(PO_35_iso,lag.max = 5)
model=auto.arima(PO_35_iso)
summary(model)
```

```{r}
model_PO_35_iso=arima(PO_35_iso,order=c(2,1,1))
summary(model_PO_35_iso)
```

```{r}
PO_35_rec=c(0.05545723, 0.05899705, 0.05589971, 0.05722714, 0.06017699,
          0.05471976, 0.05523599, 0.05619469, 0.05612094, 0.05538348,
          0.05545723, 0.05597345, 0.05353982, 0.05641593, 0.05184366,
          0.05162242, 0.05331858, 0.05339233, 0.05405605, 0.04874631,
          0.04830383, 0.05368732, 0.04579646, 0.04653392, 0.04727139,
          0.04432153, 0.04454277, 0.05117994, 0.04749263, 0.05073746,
          0.05110619, 0.04830383, 0.04830383, 0.05324484, 0.04970501,
          0.05169617, 0.05044248, 0.04889381, 0.05427729, 0.05176991,
          0.05140118, 0.05029499, 0.05353982, 0.0509587 , 0.0479351 ,
          0.05235988, 0.05058997, 0.05376106, 0.04926254, 0.04955752,
          0.04867257, 0.04675516, 0.05      , 0.0480826 , 0.0479351 ,
          0.04852507, 0.04963127, 0.04800885, 0.05058997, 0.04668142,
          0.04823009, 0.04476401, 0.04705015, 0.05044248, 0.05036873,
          0.0509587 , 0.05066372, 0.05103245, 0.05007375, 0.04941003,
          0.04771386, 0.05258112, 0.04977876, 0.05103245, 0.04800885,
          0.04992625, 0.0480826 , 0.05      , 0.04859882, 0.04948378)

plot.ts(PO_35_rec)
acf(PO_35_rec)
pacf(PO_35_rec)
model=auto.arima(PO_35_rec)
summary(model)

```

```{r}
model_PO_35_rec=arima(PO_35_iso,order=c(2,1,0))
summary(model_PO_35_rec)
```

```{r}

PO_60_awake=c(0.07352507, 0.07367257, 0.07522124, 0.07514749, 0.07315634,
          0.07219764, 0.07780236, 0.07109145, 0.07551622, 0.07278761,
          0.07632743, 0.075     , 0.0679941 , 0.07323009, 0.07315634,
          0.07300885, 0.07345133, 0.07249263, 0.07323009, 0.06917404,
          0.0719764 , 0.05648968, 0.05103245, 0.04926254, 0.04882006,
          0.04778761, 0.05412979, 0.05958702, 0.05877581, 0.06312684,
          0.06275811, 0.06312684, 0.06910029, 0.06806785, 0.07190265,
          0.08443953, 0.09196165, 0.10014749, 0.09513274, 0.09026549,
          0.09011799, 0.08620944, 0.08702065, 0.08842183, 0.08974926,
          0.08687316, 0.09026549, 0.08244838, 0.08495575, 0.08178466,
          0.08532448, 0.08281711, 0.08171091, 0.07935103, 0.08370206,
          0.08156342, 0.08016224, 0.08930678, 0.08473451, 0.08414454,
          0.08827434, 0.08702065, 0.08333333, 0.08628319, 0.08259587,
          0.08311209, 0.0839233 , 0.08333333, 0.07986726, 0.07603245,
          0.07588496, 0.0770649 , 0.07920354, 0.07817109, 0.07935103,
          0.07640118, 0.07330383, 0.07219764, 0.07662242, 0.03303835)

plot.ts(PO_60_awake)
acf(PO_60_awake)
pacf(PO_60_awake)
model=auto.arima(PO_60_awake)
summary(model)
```

```{r}
model_60_awake_PO=arima(PO_60_awake,order=c(1,0,0
                                            ))


summary(model_60_awake_PO)
```

```{r}
PO_60_iso=c(0.01165192, 0.01106195, 0.0130531 , 0.01327434, 0.01349558,
          0.0119469 , 0.01106195, 0.01143068, 0.01032448, 0.01253687,
          0.00966077, 0.0119469 , 0.0109882 , 0.00921829, 0.0109882 ,
          0.01039823, 0.01069322, 0.01150442, 0.01047198, 0.0109882 ,
          0.01261062, 0.01430678, 0.01268437, 0.01128319, 0.01017699,
          0.0089233 , 0.00914454, 0.00951327, 0.01061947, 0.00966077,
          0.01032448, 0.0079646 , 0.01091445, 0.01113569, 0.00980826,
          0.00833333, 0.00929204, 0.01047198, 0.00966077, 0.01061947,
          0.01172566, 0.01106195, 0.01216814, 0.01120944, 0.00914454,
          0.01128319, 0.01268437, 0.01150442, 0.01202065, 0.01253687,
          0.00899705, 0.01069322, 0.01120944, 0.01010324, 0.01179941,
          0.01224189, 0.01010324, 0.01054572, 0.01216814, 0.01135693,
          0.01283186, 0.01283186, 0.0149705 , 0.01371681, 0.0130531 ,
          0.01386431, 0.01202065, 0.0120944 , 0.01179941, 0.01157817,
          0.0120944 , 0.01157817, 0.01231563, 0.01393805, 0.01312684,
          0.01349558, 0.01091445, 0.01231563, 0.0119469 , 0.00567847)


plot.ts(PO_60_iso)
acf(PO_60_iso)
pacf(PO_60_iso)
model=auto.arima(PO_60_iso)
summary(model)

```

```{r}
model_60_iso_PO=arima(PO_60_iso,order=c(1,0,0))
summary(model_60_iso_PO)
```

```{r}
PO_60_recovery=c(0.05272861, 0.05346608, 0.05280236, 0.05339233, 0.0530236 ,
          0.05567847, 0.05294985, 0.05567847, 0.05066372, 0.0539823 ,
          0.0530236 , 0.05243363, 0.05265487, 0.05317109, 0.04874631,
          0.05022124, 0.05582596, 0.05412979, 0.05538348, 0.04948378,
          0.0579646 , 0.05671091, 0.04911504, 0.04011799, 0.03974926,
          0.03938053, 0.03856932, 0.04129794, 0.04410029, 0.04373156,
          0.04705015, 0.04579646, 0.04292035, 0.04845133, 0.04454277,
          0.04778761, 0.05066372, 0.05464602, 0.05685841, 0.0550885 ,
          0.05612094, 0.05781711, 0.06047198, 0.0539823 , 0.05383481,
          0.05324484, 0.05759587, 0.05685841, 0.054941  , 0.054941  ,
          0.05759587, 0.04970501, 0.05103245, 0.05081121, 0.04837758,
          0.04933628, 0.05103245, 0.05626844, 0.05567847, 0.05383481,
          0.05479351, 0.05331858, 0.05774336, 0.05221239, 0.05405605,
          0.05818584, 0.05294985, 0.05530973, 0.0570059 , 0.05412979,
          0.05707965, 0.05589971, 0.05221239, 0.05022124, 0.05014749,
          0.04948378, 0.05036873, 0.05516224, 0.05309735, 0.05117994)


plot.ts(PO_60_recovery)
acf(PO_60_recovery)
pacf(PO_60_recovery)
model=auto.arima(PO_60_recovery)
summary(model)


```

```{r}

VPM_15_awake=c(0.0574359 , 0.05884615, 0.06012821, 0.05717949, 0.06282051,
          0.05717949, 0.05525641, 0.05807692, 0.05717949, 0.05961538,
          0.06179487, 0.05935897, 0.05897436, 0.05474359, 0.05602564,
          0.05794872, 0.05692308, 0.05948718, 0.05692308, 0.0525641 ,
          0.05346154, 0.04551282, 0.03576923, 0.04      , 0.04641026,
          0.05115385, 0.05192308, 0.05333333, 0.05423077, 0.05730769,
          0.06358974, 0.06935897, 0.07423077, 0.06871795, 0.06397436,
          0.06692308, 0.06538462, 0.06769231, 0.06641026, 0.06358974,
          0.06538462, 0.06115385, 0.05820513, 0.05641026, 0.06076923,
          0.06115385, 0.05974359, 0.06205128, 0.06192308, 0.05602564,
          0.05833333, 0.06346154, 0.06128205, 0.06128205, 0.06564103,
          0.06641026, 0.06474359, 0.05948718, 0.05961538, 0.05589744,
          0.06153846, 0.05935897, 0.05769231, 0.05782051, 0.05282051,
          0.05794872, 0.05551282, 0.0575641 , 0.05538462, 0.05641026,
          0.06012821, 0.05974359, 0.0624359 , 0.05871795, 0.05512821,
          0.05679487, 0.05474359, 0.055     , 0.05346154, 0.02230769)

plot.ts(VPM_15_awake)
acf(VPM_15_awake)
pacf(VPM_15_awake)
model=auto.arima(VPM_15_awake)
summary(model)


```

```{r}
VPM_15_iso=c(0.00794872, 0.00384615, 0.00384615, 0.00628205, 0.00666667,
          0.0075641 , 0.00653846, 0.00512821, 0.00679487, 0.00538462,
          0.00487179, 0.00615385, 0.00705128, 0.00602564, 0.00487179,
          0.00487179, 0.00397436, 0.00589744, 0.00435897, 0.00461538,
          0.00525641, 0.00794872, 0.00807692, 0.00576923, 0.00487179,
          0.00448718, 0.005     , 0.00320513, 0.00423077, 0.00705128,
          0.00538462, 0.00474359, 0.00564103, 0.00512821, 0.00641026,
          0.00641026, 0.00602564, 0.00641026, 0.00641026, 0.00846154,
          0.00910256, 0.00589744, 0.00769231, 0.00628205, 0.00589744,
          0.00692308, 0.00717949, 0.00846154, 0.00641026, 0.00602564,
          0.00397436, 0.00397436, 0.005     , 0.00294872, 0.00448718,
          0.00666667, 0.00307692, 0.00410256, 0.005     , 0.00307692,
          0.00576923, 0.00602564, 0.00397436, 0.00525641, 0.00487179,
          0.00448718, 0.00384615, 0.00346154, 0.00371795, 0.00333333,
          0.00358974, 0.00410256, 0.00705128, 0.00794872, 0.00666667,
          0.00294872, 0.00282051, 0.00487179, 0.00487179, 0.00666667)



plot.ts(VPM_15_iso)
acf(VPM_15_iso)
pacf(VPM_15_iso)
model=auto.arima(VPM_15_iso)
summary(model)

```

```{r}
VPM_15_recovery=c(0.02551282, 0.02141026, 0.02076923, 0.0225641 , 0.02589744,
          0.02564103, 0.02820513, 0.02564103, 0.02602564, 0.02794872,
          0.02461538, 0.02333333, 0.02397436, 0.02730769, 0.02384615,
          0.02358974, 0.02076923, 0.02179487, 0.01961538, 0.01782051,
          0.02012821, 0.01782051, 0.02038462, 0.02064103, 0.02179487,
          0.02089744, 0.02653846, 0.02615385, 0.02615385, 0.025     ,
          0.02487179, 0.02653846, 0.025     , 0.02615385, 0.02576923,
          0.02653846, 0.02628205, 0.025     , 0.02576923, 0.02589744,
          0.02512821, 0.02794872, 0.02307692, 0.02615385, 0.02384615,
          0.02320513, 0.02064103, 0.02333333, 0.02153846, 0.02192308,
          0.02153846, 0.02897436, 0.02461538, 0.02410256, 0.02217949,
          0.02910256, 0.02551282, 0.02692308, 0.02602564, 0.02897436,
          0.02769231, 0.02717949, 0.02602564, 0.02846154, 0.02717949,
          0.03038462, 0.02666667, 0.02512821, 0.02435897, 0.02653846,
          0.02846154, 0.02512821, 0.02512821, 0.03      , 0.02307692,
          0.02384615, 0.02512821, 0.02602564, 0.02628205, 0.02974359)


plot.ts(VPM_15_recovery)
acf(VPM_15_recovery)
pacf(VPM_15_recovery)
model=auto.arima(VPM_15_recovery)
summary(model)
```

```{r}

VPM_35_awake=c(0.04897436, 0.04448718, 0.05      , 0.04769231, 0.05038462,
          0.05205128, 0.05141026, 0.05217949, 0.05653846, 0.04576923,
          0.04948718, 0.05012821, 0.05397436, 0.05871795, 0.05833333,
          0.05294872, 0.05474359, 0.05564103, 0.05333333, 0.05064103,
          0.10833333, 0.06205128, 0.01846154, 0.01038462, 0.01115385,
          0.01294872, 0.01397436, 0.01435897, 0.01448718, 0.02448718,
          0.04102564, 0.055     , 0.06717949, 0.09730769, 0.13294872,
          0.13358974, 0.10987179, 0.10512821, 0.10230769, 0.09192308,
          0.08910256, 0.09038462, 0.08269231, 0.06846154, 0.06705128,
          0.06346154, 0.06102564, 0.07320513, 0.07192308, 0.07512821,
          0.05961538, 0.0674359 , 0.07025641, 0.06333333, 0.06384615,
          0.05589744, 0.0624359 , 0.06474359, 0.06410256, 0.05448718,
          0.06192308, 0.05397436, 0.05884615, 0.05448718, 0.0475641 ,
          0.05307692, 0.06089744, 0.05794872, 0.06230769, 0.05602564,
          0.05679487, 0.06115385, 0.05448718, 0.0474359 , 0.05525641,
          0.05987179, 0.05525641, 0.05448718, 0.0525641 , 0.03807692)


plot.ts(VPM_35_awake)
acf(VPM_35_awake)
pacf(VPM_35_awake)
model=auto.arima(VPM_35_awake)
summary(model)
```

```{r}

VPM_35_iso=c(0.00397436, 0.00448718, 0.00474359, 0.00602564, 0.00666667,
          0.00602564, 0.00705128, 0.00564103, 0.00487179, 0.00474359,
          0.00320513, 0.00346154, 0.00384615, 0.00397436, 0.00435897,
          0.00602564, 0.0074359 , 0.00551282, 0.00282051, 0.00358974,
          0.00512821, 0.00679487, 0.00576923, 0.00115385, 0.00038462,
          0.00038462, 0.00179487, 0.00141026, 0.00269231, 0.00487179,
          0.00371795, 0.00230769, 0.0024359 , 0.0024359 , 0.0024359 ,
          0.00128205, 0.00230769, 0.00346154, 0.00384615, 0.00358974,
          0.005     , 0.00448718, 0.00576923, 0.00474359, 0.00628205,
          0.00448718, 0.00448718, 0.00307692, 0.00230769, 0.00589744,
          0.00576923, 0.00474359, 0.00371795, 0.00320513, 0.00423077,
          0.00384615, 0.00410256, 0.00512821, 0.00423077, 0.00448718,
          0.00423077, 0.00423077, 0.00576923, 0.00628205, 0.00628205,
          0.00551282, 0.00615385, 0.00551282, 0.00551282, 0.005     ,
          0.00346154, 0.00294872, 0.00448718, 0.00358974, 0.00551282,
          0.00307692, 0.00320513, 0.00333333, 0.00423077, 0.0025641)



plot.ts(VPM_35_iso)
acf(VPM_35_iso)
pacf(VPM_35_iso)
model=auto.arima(VPM_35_iso)
summary(model)
```

```{r}
VPM_35_recovery=c(0.02512821, 0.02871795, 0.02487179, 0.02653846, 0.02692308,
          0.02602564, 0.02807692, 0.02551282, 0.03064103, 0.02974359,
          0.02525641, 0.03051282, 0.03294872, 0.03115385, 0.02602564,
          0.025     , 0.03192308, 0.02705128, 0.02435897, 0.02474359,
          0.03217949, 0.03153846, 0.01589744, 0.01153846, 0.01012821,
          0.00910256, 0.00923077, 0.01333333, 0.01346154, 0.01666667,
          0.01871795, 0.025     , 0.02871795, 0.02846154, 0.02910256,
          0.02589744, 0.02974359, 0.03525641, 0.02897436, 0.03474359,
          0.03615385, 0.03628205, 0.03820513, 0.03397436, 0.02858974,
          0.03448718, 0.03217949, 0.0325641 , 0.02910256, 0.02923077,
          0.02846154, 0.02512821, 0.025     , 0.02269231, 0.02205128,
          0.02692308, 0.02769231, 0.0224359 , 0.02564103, 0.02384615,
          0.02141026, 0.01897436, 0.02076923, 0.01935897, 0.02474359,
          0.02551282, 0.02384615, 0.02064103, 0.01961538, 0.02384615,
          0.02474359, 0.02153846, 0.02089744, 0.0224359 , 0.02410256,
          0.0224359 , 0.02269231, 0.02128205, 0.02269231, 0.02346154)

plot.ts(VPM_35_recovery)
acf(VPM_35_recovery)
pacf(VPM_35_recovery)
model=auto.arima(VPM_35_recovery)
summary(model)

Box.test(residuals(model))
```

```{r}
VPM_60_awake=c(0.06320513, 0.06282051, 0.05948718, 0.06205128, 0.06128205,
          0.05897436, 0.06282051, 0.05769231, 0.05820513, 0.06333333,
          0.05717949, 0.06076923, 0.05858974, 0.05910256, 0.06089744,
          0.06166667, 0.05794872, 0.05589744, 0.05935897, 0.05602564,
          0.30833333, 0.13615385, 0.00782051, 0.0074359 , 0.00794872,
          0.00666667, 0.00641026, 0.00923077, 0.01371795, 0.01987179,
          0.03269231, 0.06141026, 0.09923077, 0.14358974, 0.16179487,
          0.17474359, 0.15166667, 0.13679487, 0.12923077, 0.12384615,
          0.11141026, 0.09538462, 0.1024359 , 0.10141026, 0.095     ,
          0.10333333, 0.09089744, 0.09153846, 0.09115385, 0.08858974,
          0.09064103, 0.08935897, 0.08961538, 0.09153846, 0.08064103,
          0.08435897, 0.08205128, 0.07602564, 0.08717949, 0.08320513,
          0.07679487, 0.07641026, 0.07589744, 0.07487179, 0.07705128,
          0.07282051, 0.07141026, 0.07525641, 0.0674359 , 0.06910256,
          0.06884615, 0.06576923, 0.06987179, 0.06884615, 0.06974359,
          0.06705128, 0.0674359 , 0.06846154, 0.0775641 , 0.03461538)


plot.ts(VPM_60_awake)
acf(VPM_60_awake)
pacf(VPM_60_awake)
model=auto.arima(VPM_60_awake)
summary(model)


```

```{r}
VPM_60_iso=c(0.00564103, 0.00576923, 0.00653846, 0.00653846, 0.00628205,
          0.00615385, 0.00666667, 0.00666667, 0.00653846, 0.00858974,
          0.00551282, 0.00602564, 0.00333333, 0.00307692, 0.00461538,
          0.00602564, 0.00589744, 0.00448718, 0.00423077, 0.005     ,
          0.01730769, 0.01846154, 0.00935897, 0.00051282, 0.00064103,
          0.00115385, 0.00115385, 0.00141026, 0.00038462, 0.00051282,
          0.00141026, 0.00089744, 0.00205128, 0.00179487, 0.00217949,
          0.00166667, 0.00153846, 0.00217949, 0.00217949, 0.00384615,
          0.00410256, 0.00461538, 0.0025641 , 0.005     , 0.00602564,
          0.00371795, 0.00384615, 0.00397436, 0.005     , 0.00423077,
          0.00358974, 0.00230769, 0.00307692, 0.0024359 , 0.00512821,
          0.00628205, 0.00564103, 0.00397436, 0.00487179, 0.00269231,
          0.00205128, 0.00294872, 0.0075641 , 0.00448718, 0.00602564,
          0.00653846, 0.00615385, 0.00641026, 0.00602564, 0.00551282,
          0.00307692, 0.00358974, 0.00705128, 0.00602564, 0.00782051,
          0.00769231, 0.005     , 0.00371795, 0.00358974, 0.00051282)


plot.ts(VPM_60_iso)
acf(VPM_60_iso)
pacf(VPM_60_iso)
model=auto.arima(VPM_60_iso)
summary(model)


```

```{r}

VPM_60_recovery=c(0.02358974, 0.02384615, 0.02666667, 0.02564103, 0.02871795,
          0.02794872, 0.02410256, 0.02576923, 0.02794872, 0.02948718,
          0.03051282, 0.02935897, 0.02730769, 0.02705128, 0.02525641,
          0.02641026, 0.02525641, 0.0225641 , 0.02833333, 0.02435897,
          0.05435897, 0.04564103, 0.01166667, 0.00461538, 0.00333333,
          0.00653846, 0.00512821, 0.0074359 , 0.00974359, 0.01102564,
          0.01089744, 0.01961538, 0.03038462, 0.03551282, 0.0374359 ,
          0.04782051, 0.04628205, 0.04525641, 0.04935897, 0.055     ,
          0.04474359, 0.04102564, 0.04076923, 0.0375641 , 0.03833333,
          0.04      , 0.03641026, 0.03705128, 0.04      , 0.03064103,
          0.02974359, 0.03384615, 0.02987179, 0.02833333, 0.02564103,
          0.03346154, 0.03025641, 0.03076923, 0.02653846, 0.03192308,
          0.03269231, 0.02628205, 0.02487179, 0.03012821, 0.02846154,
          0.02371795, 0.02102564, 0.02358974, 0.02564103, 0.02333333,
          0.0225641 , 0.02692308, 0.02564103, 0.02384615, 0.02294872,
          0.0224359 , 0.02012821, 0.02051282, 0.02307692, 0.02435897)

plot.ts(VPM_60_recovery)
acf(VPM_60_recovery)
pacf(VPM_60_recovery)
model=auto.arima(VPM_60_recovery)
summary(model)


```




### Multivariate Timse series modelling 
```{r}


library(forecast)
library(MTS)

## Vector autoregressive models
LD_15_awake
VPM_15_awake
PO_15_awake

# Combine into a data frame
df <- data.frame( LD_15_awake, VPM_15_awake,PO_15_awake)

# View the data frame
#print(df)


ccm(df)
#ma(df,lag=10)


#install.packages("rEDM")  # if not already installed
#library(rEDM)




#CCM(df)



```

```{r}
#install.packages("igraph")
library(igraph)
# Define edges: from → to (for significant causality)
edges <- data.frame(
  from = c("LD", "LD", "VPM"),
  to   = c("PO", "VPM", "PO"),
  weight = c(0.763, 0.530, 0.506)  # Optional: CCM values for edge thickness
)


# Create directed graph
g <- graph_from_data_frame(edges, directed = TRUE)

# Plot with weights as edge thickness
plot(g, 
     edge.width = edges$weight * 5,  # Scale thickness
     edge.arrow.size = 0.5,
     vertex.size = 30,
     vertex.color = "lightblue",
     vertex.label.cex = 1.2,
     edge.color = "darkred",
     main = "CCM-Based Causal Graph")



E(g)$label <- c("lag 0", "lag 1", "lag 1-4")  # Example labels
plot(g, 
     edge.width = edges$weight * 5,
     edge.arrow.size = 0.5,
     vertex.size = 30,
     vertex.color = "lightblue",
     vertex.label.cex = 1.2,
     edge.color = "darkred",
     edge.label = E(g)$label,  # Show lag info
     main = "CCM-Based Causal Graph with Lags")


```

```{r}
library(igraph)

# Define edges: from → to (for significant causality)
edges <- data.frame(
  from = c("LD", "LD", "VPM"),
  to   = c("PO", "VPM", "PO"),
  weight = c(0.763, 0.530, 0.506)  # Optional: CCM values for edge thickness
)

# Create directed graph
g <- graph_from_data_frame(edges, directed = TRUE)

# Set visual styles
plot(g,
     edge.width = edges$weight * 5,      # Edge thickness scaled
     edge.arrow.size = 2,                # BIG arrowheads
     edge.arrow.width = 1.5,             # Wider arrow shaft
     edge.color = "blue",             # Arrow color
     vertex.size = 40,                   # Bigger nodes
     vertex.label.cex = 1.5,             # Bigger font
     vertex.color = "skyblue",           # Node color
     vertex.frame.color = "black",       # Node border
     layout = layout_in_circle,          # Circular layout for clarity
     main = "CCM-Based Causal Graph")    # Title



```

```{r}
mq(df,lag=10)

#p-value = 0 (actually very small, <0.0001) at all lags ⇒ reject the null hypothesis at all tested lags.

#Null Hypothesis (H₀): No autocorrelation up to lag m.

#Since H₀ is rejected for all lags:
#the  time series or residuals show significant autocorrelation.

```

```{r}
VARorder(df,output = T)
```

```{r}
MTSplot(df)
m1=VAR(df,1)

#class(m1)
m1


```

```{r}

serial.test(m1)
#resi=residuals(m1)
#resi
#mq(resi,adj = 18)

#resi
```

```{r}
# Residual ACF plots
acf(resi[,1], main = "ACF of Residual - LD_15_awake")
acf(resi[,2], main = "ACF of Residual - VPM_15_awake")
acf(resi[,3], main = "ACF of Residual - PO_15_awake")

```

```{r}
serial.test(m1, type = "PT.adjusted")

```

```{r}
causality(m1,"LD_15_awake")
causality(m1,"VPM_15_awake")
causality(m1,"PO_15_awake")

```

```{r}
# Load necessary library
library(igraph)

# Define the nodes (variables)
nodes <- c("VPM", "LD", "PO")

# Define the edges based on Granger causality (significant p-values)
edges <- c(
  "VPM", "LD",  # VPM → LD (Granger causality)
  "VPM", "PO"  # VPM → PO (Granger causality)
  )

# Create a directed graph based on the edges
g <- graph_from_edgelist(matrix(edges, ncol = 2, byrow = TRUE), directed = TRUE)

# Plot the graph
plot(g,
     vertex.size = 50,                  # Size of the vertices
     vertex.label.cex = 1.2,            # Size of the labels
     vertex.color = "lightblue",        # Color of the nodes
     edge.arrow.size = 0.6,             # Size of the arrows
     main = "Granger Causality Network (15 Awake)"
)
```

**Portmanteau Test (adjusted) for residual autocorrelation** gives:

✅ **p-value = 1** → No significant autocorrelation in residuals.

This confirms that your **VAR(1) model is well-specified**, and you **do not need to update the lag order**.

------------------------------------------------------------------------

### **Final Takeaways**

1️⃣ **VAR(1) is appropriate** (AIC, BIC, HQ, and residual tests support this).\
2️⃣ **No autocorrelation issues** (residuals pass the Portmanteau test).\

```{r}
vars::roots(m1) # satbility of the model

```

**VAR(1) stability check** using roots of the companion matrix shows:

🔹 **All roots are within the unit circle** (i.e., all values \< 1).

✅ **This confirms that your VAR(1) model is stable**, meaning the process does not explode over time and remains stationary.

------------------------------------------------------------------------

### **Summary of Your VAR(1) Model**

✔ **Optimal lag order** → Selected via AIC, BIC, HQ criteria.\
✔ **No residual autocorrelation** → Passed Portmanteau test.\
✔ **Model stability confirmed** → Roots within the unit circle.

```{r}


```

```{r}
#VARselect(data, lag.max = 10, type = "const")


```

```{r}

```

```{r}
df35=data.frame(LD_35_awake,PO_35_awake,VPM_35_awake)

ccm(df35)

```

```{r}

mq(df35,lag=10)

#p-value = 0 (actually very small, <0.0001) at all lags ⇒ reject the null hypothesis at all tested lags.

#Null Hypothesis (H₀): No autocorrelation up to lag m.

#Since H₀ is rejected for all lags:
#the  time series or residuals show significant autocorrelation.

```

### **Interpreting the Ljung-Box Test Results**

The **Ljung-Box test** is used to check for autocorrelation in residuals. If the residuals are **uncorrelated**, the test statistic should not be significant (i.e., high p-values). However, your results show:

| Lag (m) | Q(m)  | df  | p-value |
|---------|-------|-----|---------|
| 1       | 75.6  | 9   | 0.000   |
| 2       | 121.8 | 18  | 0.000   |
| 3       | 153.5 | 27  | 0.000   |
| 4       | 180.2 | 36  | 0.000   |
| ...     | ...   | ... | ...     |
| 10      | 313.7 | 90  | 0.000   |

### **Key Takeaways:**

1.  **Q(m) values increase with lag**, which is expected.
2.  **p-values are all 0**, meaning the test is rejecting the null hypothesis **at all lags**.
3.  **Interpretation**: Your residuals **are NOT white noise**, meaning **they exhibit autocorrelation**.

------------------------------------------------------------------------

### **What This Means for our Model**

-   **A good model should have white noise residuals** (i.e., no significant autocorrelation).\
-   Since your p-values are **extremely low**, your residuals **are correlated**, suggesting:
    -   Your model **might be misspecified**.
    -   There could be **missing variables**.
    -   Your **lag structure may need adjustment**.

### **Next Steps**

-   Consider **adding more lags** to your VAR/SVAR model.
-   Try **differencing the data** if non-stationary.
-   Perform **ACF/PACF plots** on residuals to understand autocorrelation structure.

```{r}

VARorder(df35,output = T)
```

```{r}
MTSplot(df35)
m2=VAR(df35,1)

#class(m1)
m2


```

```{r}
#resi2=residuals(m2)


serial.test(m2, type = "PT.adjusted")

```

**Portmanteau Test (adjusted) for residual autocorrelation** gives:

✅ \*\*p-value = 0.9124\* → No significant autocorrelation in residuals.

This confirms that your **VAR(1) model is well-specified**, and you **do not need to update the lag order**.

------------------------------------------------------------------------

### **Final Takeaways**

1️⃣ **VAR(1) is appropriate** (AIC, BIC, HQ, and residual tests support this).\
2️⃣ **No autocorrelation issues** (residuals pass the Portmanteau test).\
3️⃣ **Granger causality suggests variable relationships**, but the model itself is statistically valid.

```{r}



library(vars)

# Assuming m1 is your fitted VAR(1) model
# Test if Y1 causes Y2
causality(m2, cause = "LD_35_awake") 

# Test if Y2 causes Y1
causality(m2, cause = "PO_35_awake")

causality(m2,cause="VPM_35_awake")

```

### **Interpreting Granger Causality and Instantaneous Causality Tests for VAR Model**

These tests examine **causal relationships** between the three variables:\
- **LD_35_awake**\
- **PO_35_awake**\
- **VPM_35_awake**

Each test checks if one variable **Granger-causes** another, meaning past values of one variable improve predictions of the other.

------------------------------------------------------------------------

## **1️⃣ Granger Causality Tests (Lagged Influence)**

**Null Hypothesis (H0):** *X does not Granger-cause Y*

| **Causal Relationship**                       | **F-Test Statistic** | **p-value**            | **Conclusion (α = 0.05)** |
|----------------------|----------------|----------------|------------------|
| **LD_35_awake → (PO_35_awake, VPM_35_awake)** | 0.252                | 0.777                  | ❌ No causality           |
| **PO_35_awake → (LD_35_awake, VPM_35_awake)** | 5.186                | 0.006                  | ✅ Significant causality  |
| **VPM_35_awake → (LD_35_awake, PO_35_awake)** | 17.186               | $1.133 \times 10^{-7}$ | ✅ Strong causality       |

### **Conclusions:**

-   **LD_35_awake does not Granger-cause PO_35_awake or VPM_35_awake** (p = 0.777).\
-   **PO_35_awake Granger-causes LD_35_awake & VPM_35_awake** (p = 0.006 → significant).\
-   **VPM_35_awake strongly Granger-causes LD_35_awake & PO_35_awake** (p ≈ 0.0000001 → highly significant).

------------------------------------------------------------------------

## **2️⃣ Instantaneous Causality Tests (Contemporaneous Influence)**

**Null Hypothesis (H0):** *No instantaneous causality between X and Y*\
(Checks if variables are **simultaneously correlated**, not predicting each other over time.)

| **Instantaneous Relationship**                | **Chi-squared** | **p-value**           | **Conclusion (α = 0.05)**              |
|---------------------------|---------------|---------------|---------------|
| **LD_35_awake ↔ (PO_35_awake, VPM_35_awake)** | 25.212          | $3.35 \times 10^{-6}$ | ✅ Strong instantaneous causality      |
| **PO_35_awake ↔ (LD_35_awake, VPM_35_awake)** | 19.426          | $6.05 \times 10^{-5}$ | ✅ Significant instantaneous causality |
| **VPM_35_awake ↔ (LD_35_awake, PO_35_awake)** | 17.342          | 0.00017               | ✅ Significant instantaneous causality |

### **Conclusions:**

-   **All three variables show significant instantaneous causality with each other.**\
-   This suggests **strong contemporaneous correlations** (they move together at the same time).\
-   This might indicate a **common external influence** affecting all three simultaneously.

------------------------------------------------------------------------

## **📌 Final Takeaways**

1.  **VPM_35_awake has the strongest predictive (Granger-causal) influence** on the other variables.
2.  **PO_35_awake also has a predictive effect, but weaker than VPM_35_awake.**
3.  **LD_35_awake does not significantly predict the others.**
4.  **All variables are contemporaneously correlated, meaning they influence each other at the same time, possibly due to an external factor.**

```{r}
library(igraph)

# Define node labels without "awake" and "35"
nodes <- c("LD", "PO", "VPM")

# Define edges based on significant p-values (p < 0.05)
edges <- c()

# Granger causality
if (0.006282 < 0.05) edges <- c(edges, "PO", "LD")  # PO -> LD
if (1.133e-07 < 0.05) edges <- c(edges, "VPM", "LD")  # VPM -> LD
if (1.133e-07 < 0.05) edges <- c(edges, "VPM", "PO")  # VPM -> PO

# Create a directed graph
graph <- graph(edges, directed=TRUE)

# Plot the graph with clean labels
plot(graph, 
     vertex.size=40, 
     vertex.color="blue", 
     vertex.frame.color="white", 
     vertex.label.color="white", 
     vertex.label=c("LD", "PO", "VPM"),  # Cleaned labels
     edge.arrow.size=1, 
     main="Granger Causality Network (35 Awake)")

```

## \*\* for parameter 60

```{r}

df60=data.frame(LD_60_awake,PO_60_awake,VPM_60_awake)

ccm(df60)


```

```{r}
mq(df60,lag=10)

#p-value = 0 (actually very small, <0.0001) at all lags ⇒ reject the null hypothesis at all tested lags.

#Null Hypothesis (H₀): No autocorrelation up to lag m.

#Since H₀ is rejected for all lags:
#the  time series or residuals show significant autocorrelation.

```

```{r}

VARorder(df60,output = T)
```

```{r}
MTSplot(df60)
m3=VAR(df60,1)

#class(m1)
m3


```

```{r}

serial.test(m3, type = "PT.adjusted")
```

```{r}


# Assuming m1 is your fitted VAR(1) model
# Test if Y1 causes Y2
causality(m3, cause = "LD_60_awake") 

# Test if Y2 causes Y1
causality(m3, cause = "PO_60_awake")

causality(m3,cause="VPM_60_awake")

```

### **Interpretation of the Granger and Instantaneous Causality Results**

#### **1. Granger Causality (Predictive Relationship Over Time)**

Granger causality tests whether past values of one variable help predict another. The null hypothesis (H₀) states that the first variable does **not** Granger-cause the second.

-   **LD → (PO, VPM)**
    -   F-Test = 5.308, p-value = **0.0056** (Significant, p \< 0.05)
    -   **Interpretation**: LD significantly Granger-causes PO and VPM, meaning past values of LD contain information that helps predict PO and VPM.
-   **PO → (LD, VPM)**
    -   F-Test = 0.3687, p-value = **0.692** (Not significant)
    -   **Interpretation**: PO does **not** Granger-cause LD or VPM, meaning past values of PO do not significantly predict LD and VPM.
-   **VPM → (LD, PO)**
    -   F-Test = 4.2419, p-value = **0.0156** (Significant, p \< 0.05)
    -   **Interpretation**: VPM significantly Granger-causes LD and PO, meaning past values of VPM contain predictive information for LD and PO.

#### **2. Instantaneous Causality (Contemporaneous Relationship)**

Instantaneous causality tests whether two variables influence each other at the same time. The null hypothesis (H₀) states there is **no instantaneous causality**.

-   **LD ↔ (PO, VPM)**
    -   Chi-squared = 32.323, p-value = **9.577e-08** (Significant, p \< 0.05)
    -   **Interpretation**: LD has a strong **instantaneous causal** relationship with PO and VPM, meaning changes in LD occur at the same time as changes in PO and VPM.
-   **PO ↔ (LD, VPM)**
    -   Chi-squared = 27.39, p-value = **1.128e-06** (Significant, p \< 0.05)
    -   **Interpretation**: PO and (LD, VPM) have an **instantaneous** relationship, suggesting that when PO changes, LD and VPM also change at the same moment.
-   **VPM ↔ (LD, PO)**
    -   Chi-squared = 24.388, p-value = **5.061e-06** (Significant, p \< 0.05)
    -   **Interpretation**: VPM and (LD, PO) have a **significant instantaneous relationship**, meaning that when VPM changes, LD and PO change at the same time.

------------------------------------------------------------------------

### **Overall Conclusions**

✅ **LD Granger-causes PO and VPM** → LD can predict future values of PO and VPM.\
✅ **VPM Granger-causes LD and PO** → VPM can predict future values of LD and PO.\
❌ **PO does not Granger-cause LD or VPM** → PO's past values do not provide predictive power.\
✅ **All three variables exhibit significant instantaneous causality** → Suggests a strong simultaneous interaction among them.

This suggests **bidirectional causality between LD and VPM**, while PO seems more **responsive** rather than predictive.

```{r}
library(igraph)

# Define node labels without "awake" and "60"
nodes <- c("LD", "PO", "VPM")

# Define edges based on significant p-values (p < 0.05)
edges <- c()

# Granger causality relationships
if (0.005591 < 0.05) { edges <- c(edges, "LD", "PO") }  # LD → PO
if (0.005591 < 0.05) { edges <- c(edges, "LD", "VPM") } # LD → VPM
if (0.01555 < 0.05) { edges <- c(edges, "VPM", "LD") }  # VPM → LD
if (0.01555 < 0.05) { edges <- c(edges, "VPM", "PO") }  # VPM → PO

# Create a directed graph
graph <- graph(edges, directed=TRUE)

# Plot the graph with clean labels
plot(graph, 
     vertex.size=50, 
     vertex.color="blue", 
     vertex.frame.color="white", 
     vertex.label.color="white", 
     vertex.label.cex=1.5,
     vertex.label=c("LD", "PO", "VPM"),  # Cleaned labels
     edge.arrow.size=1.5, 
     main="Granger Causality Network (60 Awake)")


```

```{r}
df_iso=data.frame(LD_15_iso,VPM_15_iso,PO_15_iso)
df_iso
```

```{r}
library(MTS)
library(forecast)
ccm(df_iso)
```

```{r}

VARorder(df_iso,output = T)

```

```{r}

MTSplot(df_iso)


```

```{r}
library(vars)
m4=VAR(df_iso,p=1)
m4

```

```{r}
mq(df_iso)

```

```{r}
serial.test(m4, type = "PT.adjusted")



```

```{r}
causality(m4, cause = "LD_15_iso") 

# Test if Y2 causes Y1
causality(m4, cause = "PO_15_iso")

causality(m4,cause="VPM_15_iso")


```

```{r}

df_iso_35=data.frame(LD_35_iso,VPM_35_iso,PO_35_iso)
df_iso_35

```

```{r}

MTSplot(df_iso_35)
```

```{r}
VARorder(df_iso_35,output = T)

```

```{r}

m5=VAR(df_iso_35,p=1)
m5
```

```{r}
ccm(df_iso_35)
```

```{r}
serial.test(m5, type = "PT.adjusted")

```

```{r}
causality(m5, cause = "LD_35_iso") 

# Test if Y2 causes Y1
causality(m5, cause = "PO_35_iso")

causality(m5,cause="VPM_35_iso")
```

```{r}

df_iso_60=data.frame(LD_60_iso,PO_60_iso,VPM_60_iso)
df_iso_60
```

```{r}

VARorder(df_iso_60,output = T)
```

```{r}
m6=VAR(df_iso_60,p=1)
m6
```

```{r}
serial.test(m6, type = "PT.adjusted")


```

```{r}
causality(m6, cause = "LD_60_iso") 

# Test if Y2 causes Y1
causality(m6, cause = "PO_60_iso")

causality(m6,cause="VPM_60_iso")
```

```{r}
df_rec_15=data.frame(LD_15_recovery,PO_15_recovery,VPM_15_recovery)
df_rec_15
```

```{r}
ccm(df_rec_15)
```

```{r}
VARorder(df_rec_15,output = T)
```

```{r}
m7=VAR(df_rec_15,p=2)
m7
```

```{r}
serial.test(m7, type = "PT.adjusted")

```

```{r}
causality(m7, cause = "LD_15_recovery") 

# Test if Y2 causes Y1
causality(m7, cause = "PO_15_recovery")

causality(m7,cause="VPM_15_recovery")
```

```{r}
df_rec_35=data.frame(LD_35_recovery,PO_35_rec,VPM_35_recovery)
df_rec_35
```

```{r}
VARorder(df_rec_35)
```

```{r}
ccm(df_rec_35)
m8=VAR(df_rec_35,p=3)
m8
serial.test(m8, type = "PT.adjusted")

causality(m8, cause = "LD_35_recovery") 

# Test if Y2 causes Y1
causality(m8, cause = "PO_35_rec")

causality(m8,cause="VPM_35_recovery")
```

```{r}
df_rec_60=data.frame(LD_60_recovery,PO_60_recovery,VPM_60_recovery)
df_rec_60
VARorder(df_rec_60)


```

```{r}
m9=VAR(df_rec_60,p=1)
m9
```

```{r}
serial.test(m9, type = "PT.adjusted")

```

```{r}
causality(m9, cause = "LD_60_recovery") 

# Test if Y2 causes Y1
causality(m9, cause = "PO_60_recovery")

causality(m9,cause="VPM_60_recovery")
```

```{r}
#hist((VPM_60_recovery))
#hist((VPM_60_recovery-mean(VPM_60_recovery))/sd(VPM_60_recovery))
#hist(VPM_60_iso)
#hist(VPM_60_awake)
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
